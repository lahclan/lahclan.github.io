<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome</title>
  <style>
    :root{
      --bg: #f9f9f9;
      --text: #333;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: var(--bg);
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
      -webkit-font-smoothing:antialiased;
    }

    .image-container{
      width: clamp(140px, 30vw, 360px);
      aspect-ratio: 1/1;
      perspective: 1200px;
      display:flex;
      align-items:center;
      justify-content:center;
      margin-bottom:20px;
      touch-action: none;
    }

    .pivot{ 
      width: 90%;
      height: 90%;
      border-radius:14px;
      overflow:hidden;
      transform-style:preserve-3d;
      will-change: transform;
      box-shadow: 0 12px 30px rgba(20,20,30,0.08);
      cursor: grab;
      background: linear-gradient(180deg, #fff 0%, #fafafa 100%);
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .pivot:active{cursor:grabbing}

    .pivot img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      user-select:none;
      pointer-events:none;
      transform-origin:center center;
    }

    .name-link{
      text-decoration:none;
      color:var(--text);
      font-size:1.1rem;
      transition:color .18s ease;
    }
    .name-link:hover{
      text-decoration:underline;
      color:black;
    }

    @media (max-width:420px){
      .name-link{font-size:1rem}
    }
  </style>
</head>
<body>
  <div class="image-container" id="container">
    <div class="pivot" id="pivot">
      <img id="profile" src="https://raw.githubusercontent.com/lahclan/lahclan.github.io/refs/heads/main/pfp%20with%20typing%20indicator-optimized%20for%20square.jpg.png" alt="Profile Image">
    </div>
  </div>

  <a class="name-link" href="https://www.lahclan.github.io/cv.html">lachlan knapp</a>

  <script>
    (function(){
      const container = document.getElementById('container');
      const pivot = document.getElementById('pivot');

      // parameters tuned for faster, snappier response
      const maxTilt = 20;
      const spring = { stiffness: 0.18, damping: 0.9 }; // higher stiffness + damping

      let targetX = 0, targetY = 0;
      let rotX = 0, rotY = 0;
      let velX = 0, velY = 0;

      let isPointerInside = false;

      function updateTransform(){
        const ax = (targetX - rotX) * spring.stiffness;
        const ay = (targetY - rotY) * spring.stiffness;

        velX = (velX + ax) * spring.damping;
        velY = (velY + ay) * spring.damping;

        rotX += velX;
        rotY += velY;

        pivot.style.transform = `rotateX(${rotX.toFixed(2)}deg) rotateY(${rotY.toFixed(2)}deg) scale(${isPointerInside ? 1.03 : 1})`;

        requestAnimationFrame(updateTransform);
      }

      function setFromPointer(clientX, clientY){
        const rect = container.getBoundingClientRect();
        const nx = (clientX - (rect.left + rect.width/2)) / (rect.width/2);
        const ny = (clientY - (rect.top + rect.height/2)) / (rect.height/2);

        const cx = Math.max(-1, Math.min(1, nx));
        const cy = Math.max(-1, Math.min(1, ny));

        targetY = cx * maxTilt;
        targetX = -cy * maxTilt;
      }

      container.addEventListener('pointermove', (e)=>{
        isPointerInside = true;
        setFromPointer(e.clientX, e.clientY);
      });

      container.addEventListener('pointerenter', ()=>{
        isPointerInside = true;
      });

      container.addEventListener('pointerleave', ()=>{
        isPointerInside = false;
        targetX = 0; targetY = 0;
      });

      let idleTick = 0;
      function idleLoop(){
        if(!isPointerInside){
          idleTick += 0.05;
          targetX = Math.sin(idleTick) * 0.8;
          targetY = Math.cos(idleTick*1.4) * 0.8;
        }
        requestAnimationFrame(idleLoop);
      }

      requestAnimationFrame(updateTransform);
      requestAnimationFrame(idleLoop);

      pivot.tabIndex = 0;
      pivot.addEventListener('focus', ()=>{ targetX = -5; targetY = 5; isPointerInside = true; });
      pivot.addEventListener('blur', ()=>{ targetX = 0; targetY = 0; isPointerInside = false; });
    })();
  </script>
</body>
</html>
